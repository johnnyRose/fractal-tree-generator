
<!doctype html>
<html>
    <head>
        <title>Fractal Tree Generator</title>
        <meta name="description" content="Fractal Tree Generator">
        <meta name="keywords" content="Fractal Tree Generator">

        <style>
            canvas {
                border: 1px solid black;
            }
        </style>
    </head>
<body>
    <h1>Fractal Tree Generator</h1>
    <canvas width="600" height="800" id="canvas">
        (HTML canvas support required)
    </canvas>

    <script type="text/javascript">
        const canvas = document.getElementById("canvas");
        
        if (!canvas.getContext) {
            alert("HTML canvas support required");
        }

        const branchLength = 250;
        const trunkBaseRatio = 0.0; // reserve the bottom X% for trunk only
        const branchLengthRatio = 0.5;
        const maxDepth = 4;
        const branchAngleDegrees = 24;
        const branchAngleRadians = degreesToRadians(branchAngleDegrees);

        const numForks = 3; // evenly distributed over the trunk, excluding the trunkBaseRatio

        // angle, length, and fork variance for randomness?

        // approximate center
        const startX = 300;
        const startY = 400;

        const ctx = canvas.getContext("2d");

        function drawTree(x, y, branchLength, angle=degreesToRadians(90), level=0) {

            ctx.beginPath();
            ctx.moveTo(x, y);

            const tipY = y - branchLength * Math.sin(angle);
            const tipX = x + branchLength * Math.cos(angle);

            ctx.lineTo(tipX, tipY);
            ctx.stroke();

            if (level < maxDepth) {

                const diffRatio = (1.0 - trunkBaseRatio) / (numForks + 1);
                const diffX = branchLength * diffRatio * Math.cos(angle);
                const diffY = branchLength * diffRatio * Math.sin(angle);

                for (let i = 0; i < numForks; i++) {
                    const attachmentPointX = tipX - diffX * (i + 1);
                    const attachmentPointY = tipY + diffY * (i + 1);

                    ctx.moveTo(attachmentPointX, attachmentPointY);
                    const newBranchLength = branchLength * branchLengthRatio;

                    drawTree(attachmentPointX, attachmentPointY, newBranchLength, branchAngleRadians + angle, level + 1);
                    drawTree(attachmentPointX, attachmentPointY, newBranchLength, angle - branchAngleRadians, level + 1);
                }

                ctx.stroke();

                //const attachmentPointX = x + offsetX + (branchLength * trunkBaseRatio) * Math.cos(angle);
                //const attachmentPointY = y - offsetY - (branchLength * trunkBaseRatio) * Math.sin(angle);

                //ctx.moveTo(attachmentPointX, attachmentPointY);
                
                // const newBranchLength = branchLength * branchLengthRatio;

                // drawTree(attachmentPointX, attachmentPointY, newBranchLength, branchAngleRadians + angle, level + 1);
                // drawTree(attachmentPointX, attachmentPointY, newBranchLength, angle - branchAngleRadians, level + 1);
            }
        }
        
        drawTree(startX, startY, branchLength);
        
        function degreesToRadians(degrees) {
            return degrees * (Math.PI / 180);
        }



    </script>
</body>
</html>
